let products = {
  data: [{
      productCode: "DMGJ1S10J",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJ1S10J.jpg"
    },

    {
      productCode: "DMGJS098",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJS098.jpg"
    },

    {
      productCode: "DMGJS098D",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJS098D.jpg"
    },

    {
      productCode: "DMGJS098E",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. CANDLE.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJS098E.jpg"
    },

    {
      productCode: "DMGJS099E",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJS099E.jpg"
    },

    {
      productCode: "DMGJD202A",
      category: {
        option1: "Jewish",
        option2: "double"
      },
      productName: "CANDLE. FLAME. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJD202A.jpg"
    },

    {
      productCode: "DMGJD203SQG",
      category: {
        option1: "Jewish",
        option2: "double"
      },
      productName: "CANDLE. FLAME. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJD203SQG.jpg"
    },

    {
      productCode: "DMGJM171C",
      category: {
        option1: "Jewish",
        option2: "double"
      },
      productName: "FLOWER. MAGEN DAVID.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJM171C.jpg"
    },

    {
      productCode: "DMGJ0087",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. MAGEN DAVID. CANDLE.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMGJ0087.jpg"
    },

    {
      productCode: "DMGJ0066",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. MAGEN DAVID.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMGJ0066.jpg"
    },

    {
      productCode: "DMGJ0066",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "CROSS. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGJ0066.jpg"
    },

    {
      productCode: "DMG397",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "CROSS. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG397.jpg"
    },

    {
      productCode: "DMG397B",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "IRISH CROSS. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG397B.jpg"
    },

    {
      productCode: "DMG404",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "IRISH CROSS. JESUS. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG404.jpg"
    },

    {
      productCode: "DMG0096",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "JESUS.FLOWER.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMG0096.jpg"
    },

    {
      productCode: "DMG0094",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "ANGEL.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMG0094.jpg"
    },

    {
      productCode: "DMGC594",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "SAINT. CROSS. FLOWER.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMGC594.jpg"
    },

    {
      productCode: "DMGC711B",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "SAINT. CROSS. FLOWER.",
      productType: "ETCHING.",
      productImage: "./assets/img/catalogImgs/DMGC711B.jpg"
    },

    {
      productCode: "DMG0002M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0002M.jpg"
    },

    {
      productCode: "DMG0003M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0003M.jpg"
    },

    {
      productCode: "DMG0007M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0007M.jpg"
    },

    {
      productCode: "DMG0008M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0008M.jpg"
    },

    {
      productCode: "DMG0014M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0014M.jpg"
    },

    {
      productCode: "DMG0016M",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOSQUE. MOON.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMG0016M.jpg"
    },

    {
      productCode: "DMGA20014M",
      category: {
        option1: "Asian",
        option2: "double"
      },
      productName: "ORNAMENT. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGA20014M.jpg"
    },

    {
      productCode: "DMGA20015M",
      category: {
        option1: "Asian",
        option2: "double"
      },
      productName: "ORNAMENT. FLOWER.",
      productType: "DOUBLE PROSES.",
      productImage: "./assets/img/catalogImgs/DMGA20015M.jpg"
    },
  ],
};

for (let i of products.data) {

  //Create Card
  var productCard = document.createElement("div");
  //Card should have category and should stay hidden initially
  productCard.classList.add("product-card", i.category.option1, i.category.option2, "hide");

  //image div
  // let imgContainer = document.createElement("div");
  let productImgBox = document.createElement("div");
  productImgBox.classList.add("product-img-box");

  //img tag
  let productImage = document.createElement("div");
  let productImageAddress = "background-image: url(" + i.productImage + ");"
  productImage.classList.add("product-img");
  productImage.setAttribute("style", productImageAddress);
  productImgBox.appendChild(productImage);
  productCard.appendChild(productImgBox);

  //container
  // let container = document.createElement("div");
  let productCaptionBox = document.createElement("div");
  productCaptionBox.classList.add("product-caption-box");
  productCard.appendChild(productCaptionBox);

  // product code
  let productCode = document.createElement("p");
  productCode.classList.add("product-caption", "product-code");
  productCode.innerText = i.productCode.toUpperCase();
  productCaptionBox.appendChild(productCode);

  // product category
  let productCategory = document.createElement("p");
  productCategory.classList.add("product-caption", "product-category");
  productCategory.innerText = i.category.option1 + ", " + i.category.option2;
  productCaptionBox.appendChild(productCategory);

  // product name
  let productCaption = document.createElement("p");
  productCaption.classList.add("product-caption", "product-name");
  productCaption.innerText = i.productName;
  productCaptionBox.appendChild(productCaption);

  // product type
  let productType = document.createElement("p");
  productType.classList.add("product-caption", "product-type");
  productType.innerText = i.productType;
  productCaptionBox.appendChild(productType);


  document.getElementById("products-box").appendChild(productCard);
  // document.getElementsByClassName(".products-box").appendChild(productCard);

  // modal
  const modalContainer = document.querySelector('.modal-container');
  const modalClose = document.querySelector('.modal-close');
  const modalBg = document.querySelector('.modal-bg');
  const modalImage = document.querySelector('.modal-image');
  const modalCaptionCode = document.querySelector('.modal-caption-code');
  const modalCaptionCategory = document.querySelector('.modal-caption-category');
  const modalCaptionName = document.querySelector('.modal-caption-name');
  const modalCaptionType = document.querySelector('.modal-caption-type');


  productCard.addEventListener('click', () => {
    document.body.style.overflow = 'hidden';
    modalContainer.classList.remove('hide');
    modalImage.setAttribute("style", productImageAddress);
    modalCaptionCode.innerText = productCode.innerText;
    modalCaptionCategory.innerText = productCategory.innerText;
    modalCaptionName.innerText = productCaption.innerText;
    modalCaptionType.innerText = productType.innerText;
  });

  modalClose.addEventListener('click', () => {
    modalContainer.classList.add('hide');
    document.body.style.overflow = 'visible';
  });
  
  modalBg.addEventListener('click', () => {
    modalContainer.classList.add('hide');
    document.body.style.overflow = 'visible';
  });

}

//parameter passed from button (Parameter same as category)
function filterProduct(value) {
  //Button class code
  let buttons = document.querySelectorAll(".radio-btn");
  buttons.forEach((button) => {
    //check if value equals innerText
    if (value.toUpperCase() == button.innerText.toUpperCase()) {
      button.classList.add("active");
    } else {
      button.classList.remove("active");
    }
  });

  //select all cards
  let elements = document.querySelectorAll(".product-card");
  //loop through all cards
  elements.forEach((element) => {
    //display all cards on 'all' button click
    if (value == "all") {
      element.classList.remove("hide");
    } else {
      //Check if element contains category class
      if (element.classList.contains(value)) {
        //display element based on category
        element.classList.remove("hide");
      } else {
        //hide other elements
        element.classList.add("hide");
      }
    }
  });
}


//Search button click
document.getElementById("primary-search-btn").addEventListener("click", () => {
  //initializations
  let searchInput = document.getElementById("primary-search-bar");
  let searchQuery = searchInput.value.toLowerCase();

  let codeSearch = document.querySelectorAll(".product-code");
  let categorySearch = document.querySelectorAll(".product-category");
  let nameSearch = document.querySelectorAll(".product-name");
  let typeSearch = document.querySelectorAll(".product-type");

  let cards = document.querySelectorAll(".product-card");


  //loop through all elements
  cards.forEach((element, index) => {
    
    //check if text includes the search value
    if(searchQuery === codeSearch[index].textContent.toLowerCase() ||
      categorySearch[index].textContent.toLowerCase().includes(searchQuery) ||
      nameSearch[index].textContent.toLowerCase().includes(searchQuery) ||
      typeSearch[index].textContent.toLowerCase().includes(searchQuery)) {

      //display matching card
      cards[index].classList.remove("hide");

    } else {
      //hide others
      cards[index].classList.add("hide");
    }
  });
});

document.getElementById("primary-search-bar").addEventListener("keypress", (event) => {
  if(event.keyCode === 13) {
    event.preventDefault();
    document.getElementById("primary-search-btn").click();
  }
});

//Initially display all products
window.onload = () => {
  filterProduct("all");
};