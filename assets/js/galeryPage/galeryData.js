let products = {
  data: [{
      productCode: "DMGJ12983",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. TULIP. MAGEN DAVID. ETCHING PORTRAIT.",
      productType: "BLACK GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ12983.jpg"
    },
    {
      productCode: "DMGJ13031",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "FLOWER. LILAC. ETCHING PORTRAIT.",
      productType: "BLACK GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ13031.jpg"
    },
    {
      productCode: "DMGJ13049",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "TREE. ETCHING PORTRAIT.",
      productType: "RED GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ13049.jpg"
    },
    {
      productCode: "DMGJ13093",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "TALITNIA. MAGEN DAVID.  ETCHING PORTRAIT.",
      productType: "RED GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ13093.jpg"
    },
    {
      productCode: "DMGJ1234",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "ROCK. CANDLE. BOOK.  ETCHING PORTRAIT.",
      productType: "BAHAMA BLUE GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ1234.jpg"
    },
    {
      productCode: "DMGJ29953",
      category: {
        option1: "Jewish",
        option2: "double"
      },
      productName: "MAGEN DAVID. FLAME.  ETCHING PORTRAIT.",
      productType: "CAT EYE BROWN GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ29953.jpg"
    },
    {
      productCode: "DMGJ13024",
      category: {
        option1: "Jewish",
        option2: "single"
      },
      productName: "ROSE. CANDLE.",
      productType: "BAHAMA BLUE GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGJ13024.jpg"
    },
    {
      productCode: "DMGC1A2983",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "HANDS. CROSS.  FLOWER.",
      productType: "ETCHING PORTRAIT. BLACK GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGC1A2983.jpg"
    },
    {
      productCode: "DMGC3A104728B",
      category: {
        option1: "Catholic",
        option2: "triple"
      },
      productName: "IRISH. CROSS.  FLOWER. ROSE.",
      productType: "GRAY GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGC3A104728B.jpg"
    },
    {
      productCode: "DMG1A125535B",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "ROSE.  FLOWER.",
      productType: "GRAY GRANITE. PORCELAIN PORTRAIT.",
      productImage: "./assets/img/galeryImgs/DMG1A125535B.jpg"
    },
    {
      productCode: "DMGC2A132751",
      category: {
        option1: "Catholic",
        option2: "double"
      },
      productName: "MARKER. ANGEL.",
      productType: "AURORA BROWN GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGC2A132751.jpg"
    },
    {
      productCode: "DMG1A115725",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "MARKER. ANGEL.",
      productType: "GRAY GRANITE.",
      productImage: "./assets/img/galeryImgs/DMG1A115725.jpg"
    },
    {
      productCode: "DMG3A130354",
      category: {
        option1: "Catholic",
        option2: "single"
      },
      productName: "CROSS. ROSARY. HANDS. FLOWER.",
      productType: "RED GRANITE. PORCELAIN PORTRAIT.",
      productImage: "./assets/img/galeryImgs/DMG3A130354.jpg"
    },
    {
      productCode: "DMG3A141746",
      category: {
        option1: "Catholic",
        option2: "triple"
      },
      productName: "CROSS. FLOWER.",
      productType: "BAHAMA BLUE GRANITE.",
      productImage: "./assets/img/galeryImgs/DMG3A141746.jpg"
    },
    {
      productCode: "DMG3A143731",
      category: {
        option1: "Catholic",
        option2: "triple"
      },
      productName: "CROSS. FLOWER. JESUS.",
      productType: "BAHAMA BLUE GRANITE. PORCELAIN PORTRAITS.",
      productImage: "./assets/img/galeryImgs/DMG3A143731.jpg"
    },
    {
      productCode: "DMGM1A0001",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT. MOON.",
      productType: "BLACK GRANITE. ETCHING PORTRAIT.",
      productImage: "./assets/img/galeryImgs/DMGM1A0001.jpg"
    },
    {
      productCode: "DMGM1A0002",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "ORNAMENT.",
      productType: "BLACK GRANITE. MOON.",
      productImage: "./assets/img/galeryImgs/DMGM1A0002.jpg"
    },
    {
      productCode: "DMGM1A0003",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "MOSQUE. MOON.",
      productType: "GRAY GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGM1A0003.jpg"
    },
    {
      productCode: "DMGM1A0004",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "MOSQUE. MOON.",
      productType: "DARK GRAY GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGM1A0004.jpg"
    },
    {
      productCode: "DMGM1A0005",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "MOON. ETCHING PORTRAITS.",
      productType: "CAT EYE BROWN GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGM1A0005.jpg"
    },
    {
      productCode: "DMGM1A0006",
      category: {
        option1: "Islamic",
        option2: "single"
      },
      productName: "FLOWER.",
      productType: "WHITE GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGM1A0006.jpg"
    },
    {
      productCode: "DMGA10001",
      category: {
        option1: "Asian",
        option2: "single"
      },
      productName: "SETCHING PORTRAIT.",
      productType: "RED GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGA10001.jpg"
    },
    {
      productCode: "DMGA10002",
      category: {
        option1: "Asian",
        option2: "single"
      },
      productName: "FLOWER.",
      productType: "BLACK GRANITE. ETCHING PORTRAIT.",
      productImage: "./assets/img/galeryImgs/DMGA10002.jpg"
    },
    {
      productCode: "DMGA2A0003",
      category: {
        option1: "Asian",
        option2: "double"
      },
      productName: "FLOWER. ROSE.",
      productType: "GRAY GRANITE.",
      productImage: "./assets/img/galeryImgs/DMGA2A0003.jpg"
    },
    {
      productCode: "DMGA2A00024",
      category: {
        option1: "Asian",
        option2: "double"
      },
      productName: "FLOWER. ROSE.",
      productType: "BLACK GRANITE. ETCHING PORTRAITS.",
      productImage: "./assets/img/galeryImgs/DMGA2A00024.jpg"
    },
    {
      productCode: "DMGA2A00025",
      category: {
        option1: "Asian",
        option2: "double"
      },
      productName: "FLOWER. ROSE.",
      productType: "BLACK GRANITE. PORCELAIN PORTRAITS.",
      productImage: "./assets/img/galeryImgs/DMGA2A00025.jpg"
    },
  ],
};

for (let i of products.data) {

  //Create Card
  var productCard = document.createElement("div");
  //Card should have category and should stay hidden initially
  productCard.classList.add("product-card", i.category.option1, i.category.option2, "hide");

  //image div
  // let imgContainer = document.createElement("div");
  let productImgBox = document.createElement("div");
  productImgBox.classList.add("product-img-box");

  //img tag
  let productImage = document.createElement("div");
  let productImageAddress = "background-image: url(" + i.productImage + ");"
  productImage.classList.add("product-img");
  productImage.setAttribute("style", productImageAddress);
  productImgBox.appendChild(productImage);
  productCard.appendChild(productImgBox);

  //container
  // let container = document.createElement("div");
  let productCaptionBox = document.createElement("div");
  productCaptionBox.classList.add("product-caption-box");
  productCard.appendChild(productCaptionBox);

  // product code
  let productCode = document.createElement("p");
  productCode.classList.add("product-caption", "product-code");
  productCode.innerText = i.productCode.toUpperCase();
  productCaptionBox.appendChild(productCode);

  // product category
  let productCategory = document.createElement("p");
  productCategory.classList.add("product-caption", "product-category");
  productCategory.innerText = i.category.option1 + ", " + i.category.option2;
  productCaptionBox.appendChild(productCategory);

  // product name
  let productCaption = document.createElement("p");
  productCaption.classList.add("product-caption", "product-name");
  productCaption.innerText = i.productName;
  productCaptionBox.appendChild(productCaption);

  // product type
  let productType = document.createElement("p");
  productType.classList.add("product-caption", "product-type");
  productType.innerText = i.productType;
  productCaptionBox.appendChild(productType);


  document.getElementById("products-box").appendChild(productCard);
  // document.getElementsByClassName(".products-box").appendChild(productCard);

  // modal
  const modalContainer = document.querySelector('.modal-container');
  const modalClose = document.querySelector('.modal-close');
  const modalBg = document.querySelector('.modal-bg');
  const modalImage = document.querySelector('.modal-image');
  const modalCaptionCode = document.querySelector('.modal-caption-code');
  const modalCaptionCategory = document.querySelector('.modal-caption-category');
  const modalCaptionName = document.querySelector('.modal-caption-name');
  const modalCaptionType = document.querySelector('.modal-caption-type');


  productCard.addEventListener('click', () => {
    modalContainer.classList.remove('hide');
    modalImage.setAttribute("style", productImageAddress);
    modalCaptionCode.innerText = productCode.innerText;
    modalCaptionCategory.innerText = productCategory.innerText;
    modalCaptionName.innerText = productCaption.innerText;
    modalCaptionType.innerText = productType.innerText;
  });

  modalClose.addEventListener('click', () => {
    modalContainer.classList.add('hide');
    document.body.style.overflow = 'visible';
  });
  
  modalBg.addEventListener('click', () => {
    modalContainer.classList.add('hide');
    document.body.style.overflow = 'visible';
  });

}

//parameter passed from button (Parameter same as category)
function filterProduct(value) {
  //Button class code
  let buttons = document.querySelectorAll(".radio-btn");
  buttons.forEach((button) => {
    //check if value equals innerText
    if (value.toUpperCase() == button.innerText.toUpperCase()) {
      button.classList.add("active");
    } else {
      button.classList.remove("active");
    }
  });

  //select all cards
  let elements = document.querySelectorAll(".product-card");
  //loop through all cards
  elements.forEach((element) => {
    //display all cards on 'all' button click
    if (value == "all") {
      element.classList.remove("hide");
    } else {
      //Check if element contains category class
      if (element.classList.contains(value)) {
        //display element based on category
        element.classList.remove("hide");
      } else {
        //hide other elements
        element.classList.add("hide");
      }
    }
  });
}


//Search button click
document.getElementById("primary-search-btn").addEventListener("click", () => {
  //initializations
  let searchInput = document.getElementById("primary-search-bar");
  let searchQuery = searchInput.value.toLowerCase();

  let codeSearch = document.querySelectorAll(".product-code");
  let categorySearch = document.querySelectorAll(".product-category");
  let nameSearch = document.querySelectorAll(".product-name");
  let typeSearch = document.querySelectorAll(".product-type");

  let cards = document.querySelectorAll(".product-card");

  //loop through all elements
  cards.forEach((element, index) => {

    //check if text includes the search value
    if(searchQuery === codeSearch[index].textContent.toLowerCase() ||
      categorySearch[index].textContent.toLowerCase().includes(searchQuery) ||
      nameSearch[index].textContent.toLowerCase().includes(searchQuery) ||
      typeSearch[index].textContent.toLowerCase().includes(searchQuery)) {

      //display matching card
      cards[index].classList.remove("hide");

    } else {
      //hide others
      cards[index].classList.add("hide");
    }
  });
});

document.getElementById("primary-search-bar").addEventListener("keypress", (event) => {
  if(event.keyCode === 13) {
    event.preventDefault();
    document.getElementById("primary-search-btn").click();
  }
});

//Initially display all products
window.onload = () => {
  filterProduct("all");
};